
require 'thread'

task :default => [:a, :b]
task :a => [:x, :y]
task :b

mutex = Mutex.new
STDOUT.sync = true

%w[a b x y].each { |name|
  task name.to_sym do
    mutex.synchronize {
      puts "task #{name}"
    }
    sleep(1)
  end
}
